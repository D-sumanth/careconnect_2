<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CareConnect</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/styles.css">

  </head>
  <body>
    <div class="top-container">
      <header>
        <h1 class="logo">
          <span class="blue-c">C</span>are<span class="blue-c">C</span>onnect
        </h1>
      </header>

      <div class="info-box">
        <p>Date: <span id="current-date"></span></p>
        <p>Time: <span id="current-time"></span></p>
        <p>In House: <span id="in-house-display">0</span></p>
        <p>New Admissions: <span id="new-admissions-display">0</span></p>
        <button id="update-info" class="update-button">
          <i class="fas fa-edit"></i> Update Information
        </button>
      </div>
    </div>
    <div id="update-popup" class="popup">
      <div class="popup-content">
        <span class="close-popup">&times;</span>
        <h2>Update Information</h2>
        <form id="update-form">
          <div class="form-group">
            <label for="in-house">In House:</label>
            <input type="number" id="in-house" min="0" required />
          </div>
          <div class="form-group">
            <label for="new-admissions">New Admissions:</label>
            <input type="number" id="new-admissions" min="0" required />
          </div>
          <button type="submit" class="submit-button">Update</button>
        </form>
      </div>
    </div>

    <div class="cards-container">
      <div class="card critical" data-type="critical">
        <h2 class="card-title">Critical</h2>
        <i class="fas fa-plus-circle plus-icon"></i>
      </div>
      <div class="card routine" data-type="routine">
        <h2 class="card-title">Routine</h2>
        <i class="fas fa-plus-circle plus-icon"></i>
      </div>
      <div class="card event-based" data-type="event-based">
        <h2 class="card-title">Event-Based</h2>
        <i class="fas fa-plus-circle plus-icon"></i>
      </div>
    </div>
    <a href="dashboard.html" class="dashboard-button">
      <i class="fas fa-chart-line"></i> View Dashboard
    </a>

    <script>
      function updateDateTime() {
        const now = new Date();
        const dd = String(now.getDate()).padStart(2, "0");
        const mm = String(now.getMonth() + 1).padStart(2, "0");
        const yyyy = now.getFullYear();
        const time = now.toLocaleTimeString();

        document.getElementById(
          "current-date"
        ).textContent = `${dd}/${mm}/${yyyy}`;
        document.getElementById("current-time").textContent = time;
      }

      updateDateTime();
      setInterval(updateDateTime, 1000);

      // Add click handlers for cards
      document.querySelectorAll(".card").forEach((card) => {
        card.addEventListener("click", function () {
          const type = this.getAttribute("data-type");
          window.location.href = `form.html?type=${type}`;
        });
      });
    </script>
    <script src="/js/shared.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize the info manager
        InfoManager.init();

        const updateButton = document.getElementById("update-info");
        const popup = document.getElementById("update-popup");
        const closePopup = document.querySelector(".close-popup");
        const updateForm = document.getElementById("update-form");

        // Show popup with current values
        updateButton.addEventListener("click", () => {
          const counts = InfoManager.getCounts();
          document.getElementById("in-house").value = counts.inHouse;
          document.getElementById("new-admissions").value =
            counts.newAdmissions;
          popup.style.display = "block";
        });

        // Close popup
        closePopup.addEventListener("click", () => {
          popup.style.display = "none";
        });

        // Close on outside click
        window.addEventListener("click", (e) => {
          if (e.target === popup) {
            popup.style.display = "none";
          }
        });

        // Handle form submission
        updateForm.addEventListener("submit", (e) => {
          e.preventDefault();
          const inHouse = document.getElementById("in-house").value;
          const newAdmissions = document.getElementById("new-admissions").value;

          InfoManager.updateCounts(inHouse, newAdmissions);
          popup.style.display = "none";
        });
      });
    </script>
  </body>
</html>
